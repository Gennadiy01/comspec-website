<!DOCTYPE html>
<html>
<head>
    <title>Telegram Debug Test</title>
</head>
<body>
    <h1>üß™ –¢–ï–°–¢ TELEGRAM –Ü–ù–¢–ï–ì–†–ê–¶–Ü–á</h1>
    <div id="results"></div>
    
    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz3XE8u5O2Q9ez4OpKcyPB6TtrGp0ul6hPJsud4Dethj0fA2ixU7t4XCwJefl4EIgAd/exec';
        
        async function testGoogleScript() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>‚è≥ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è...</p>';
            
            try {
                // –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Telegram —Ñ—É–Ω–∫—Ü—ñ–π
                console.log('üß™ –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Telegram —Ñ—É–Ω–∫—Ü—ñ–π');
                
                const telegramTestUrl = `${GOOGLE_SCRIPT_URL}?action=testTelegram`;
                const telegramResponse = await fetch(telegramTestUrl);
                const telegramData = await telegramResponse.json();
                
                console.log('üìã Telegram test result:', telegramData);
                
                let html = '<h2>üß™ –†–ï–ó–£–õ–¨–¢–ê–¢–ò –¢–ï–°–¢–£–í–ê–ù–ù–Ø</h2>';
                html += '<h3>üì± –¢–µ—Å—Ç Telegram —Ñ—É–Ω–∫—Ü—ñ–π:</h3>';
                html += `<pre>${JSON.stringify(telegramData, null, 2)}</pre>`;
                
                // –¢–µ—Å—Ç 2: –†–µ–∞–ª—å–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                console.log('üß™ –¢–µ—Å—Ç 2: –†–µ–∞–ª—å–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è');
                
                const orderData = {
                    action: 'saveOrder',
                    name: '–¢–µ—Å—Ç Browser Debug',
                    phone: '+380123456789',
                    email: 'test-browser@comspec.ua',
                    product: '–©–µ–±—ñ–Ω—å',
                    deliveryType: 'delivery',
                    address: '–º. –ö–∏—ó–≤, –≤—É–ª. –ë—Ä–∞—É–∑–µ—Ä, 1',
                    message: '–¢–µ—Å—Ç —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ managerTelegramChatId',
                    source: 'browser-debug-test',
                    mode: 'order'
                };
                
                const orderUrl = `${GOOGLE_SCRIPT_URL}?` + new URLSearchParams(orderData).toString();
                const orderResponse = await fetch(orderUrl);
                const orderResult = await orderResponse.json();
                
                console.log('üìã Order result:', orderResult);
                
                html += '<h3>üì¶ –¢–µ—Å—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:</h3>';
                html += `<pre>${JSON.stringify(orderResult, null, 2)}</pre>`;
                
                // –ê–Ω–∞–ª—ñ–∑
                html += '<h3>üîç –ê–ù–ê–õ–Ü–ó:</h3>';
                
                if (orderResult.managerTelegramChatId) {
                    html += `<p style="color: green;">‚úÖ managerTelegramChatId –∑–Ω–∞–π–¥–µ–Ω–æ: ${orderResult.managerTelegramChatId}</p>`;
                    html += '<p style="color: green;">‚úÖ Telegram –ø–æ–≤–∏–Ω–µ–Ω –ø—Ä–∞—Ü—é–≤–∞—Ç–∏!</p>';
                } else {
                    html += '<p style="color: red;">‚ùå managerTelegramChatId –í–Ü–î–°–£–¢–ù–Ü–ô!</p>';
                    html += '<p style="color: red;">‚ùå –¶–µ –ø–æ—è—Å–Ω—é—î —á–æ–º—É Telegram –Ω–µ –ø—Ä–∞—Ü—é—î</p>';
                }
                
                html += `<p><strong>–ú–µ–Ω–µ–¥–∂–µ—Ä:</strong> ${orderResult.manager}</p>`;
                html += `<p><strong>Order ID:</strong> ${orderResult.orderId}</p>`;
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('‚ùå –ü–æ–º–∏–ª–∫–∞:', error);
                resultsDiv.innerHTML = `<p style="color: red;">‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}</p>`;
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.onload = testGoogleScript;
    </script>
</body>
</html>