"use strict";(self.webpackChunkcomspec_website=self.webpackChunkcomspec_website||[]).push([[540],{540:(t,e,i)=>{i.r(e),i.d(e,{default:()=>l,initializeSearchHighlighting:()=>h}),t=i.hmd(t);class n{constructor(){this.highlightClass="comspec-search-highlight",this.currentHighlights=[],this.isInitialized=!1,this.init()}init(){try{this.initializeStyles(),this.setupGlobalFunctions(),this.setupKeyboardShortcuts(),this.isInitialized=!0}catch(t){console.error("\u274c \u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0456\u043d\u0456\u0446\u0456\u0430\u043b\u0456\u0437\u0430\u0446\u0456\u0457 SearchHighlighting:",t)}}initializeStyles(){const t="comspec-search-highlighting-styles";if(document.getElementById(t))return;const e=document.createElement("style");e.id=t,e.textContent="\n            .".concat(this.highlightClass," {\n                background: #ffeb3b !important;\n                padding: 2px 4px !important;\n                border-radius: 3px !important;\n                font-weight: 600 !important;\n                animation: comspec-pulse 1s ease-in-out !important;\n                box-shadow: 0 0 0 2px rgba(255, 235, 59, 0.3) !important;\n                color: #000 !important;\n                transition: all 0.3s ease !important;\n            }\n            \n            .").concat(this.highlightClass,":hover {\n                background: #ffcc00 !important;\n                transform: scale(1.05) !important;\n            }\n            \n            .").concat(this.highlightClass,".phone {\n                background: #03a9f4 !important;\n                color: white !important;\n                box-shadow: 0 0 0 2px rgba(3, 169, 244, 0.3) !important;\n            }\n            \n            .").concat(this.highlightClass,".address {\n                background: #ff9800 !important;\n                color: white !important;\n                box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.3) !important;\n            }\n            \n            .").concat(this.highlightClass,".email {\n                background: #2196f3 !important;\n                color: white !important;\n                box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.3) !important;\n            }\n            \n            .comspec-search-focus {\n                outline: 3px solid #008080 !important;\n                outline-offset: 5px !important;\n                border-radius: 5px !important;\n                transition: all 0.3s ease !important;\n            }\n            \n            .comspec-search-counter {\n                position: fixed !important;\n                top: 10px !important;\n                right: 10px !important;\n                background: #008080 !important;\n                color: white !important;\n                padding: 8px 16px !important;\n                border-radius: 20px !important;\n                font-size: 14px !important;\n                font-weight: bold !important;\n                z-index: 10000 !important;\n                box-shadow: 0 4px 15px rgba(0,0,0,0.2) !important;\n                animation: slideInRight 0.3s ease !important;\n            }\n            \n            @keyframes comspec-pulse {\n                0%, 100% { \n                    background: #ffeb3b !important; \n                    transform: scale(1);\n                }\n                50% { \n                    background: #ff9800 !important; \n                    transform: scale(1.05);\n                }\n            }\n            \n            @keyframes slideInRight {\n                from {\n                    transform: translateX(100%);\n                    opacity: 0;\n                }\n                to {\n                    transform: translateX(0);\n                    opacity: 1;\n                }\n            }\n        "),document.head.appendChild(e)}highlightTermInElement(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t||!e)return console.warn("\u26a0\ufe0f \u0412\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439 \u0435\u043b\u0435\u043c\u0435\u043d\u0442 \u0430\u0431\u043e \u0442\u0435\u0440\u043c\u0456\u043d \u0434\u043b\u044f \u043f\u0456\u0434\u0441\u0432\u0456\u0447\u0443\u0432\u0430\u043d\u043d\u044f"),!1;if(!t.textContent.toLowerCase().includes(e.toLowerCase()))return!1;const n=this.highlightInTextNodes(t,e,i);if(n){const e=t.querySelectorAll(".".concat(this.highlightClass));this.currentHighlights.push(...Array.from(e))}return n}highlightInTextNodes(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t.nodeType===Node.TEXT_NODE){const n=t.textContent,r=new RegExp("(".concat(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"gi");if(r.test(n)){const e=i?" ".concat(i):"",h=n.replace(r,'<span class="'.concat(this.highlightClass).concat(e,'" data-search-highlight="true">$1</span>')),l=document.createElement("div");l.innerHTML=h;const o=t.parentNode;if(o){for(;l.firstChild;)o.insertBefore(l.firstChild,t);o.removeChild(t)}return!0}}else if(t.nodeType===Node.ELEMENT_NODE&&!t.classList.contains(this.highlightClass)){let n=!1;return Array.from(t.childNodes).forEach((t=>{this.highlightInTextNodes(t,e,i)&&(n=!0)})),n}return!1}scrollToElementWithHighlight(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.clearHighlights();let h=n;if(h||(h=this.findElement(t,e,r)),!h)return!1;const l=this.applyHighlighting(h,e,i);return this.scrollToElement(h),l&&this.currentHighlights.length>0&&this.showHighlightCounter(this.currentHighlights.length,e),{element:h,highlighted:l,selector:t,term:e,highlightCount:this.currentHighlights.length}}findElement(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=[()=>document.querySelector(t),()=>document.getElementById(t.replace("#","")),()=>document.querySelector('[data-section="'.concat(t.replace("#",""),'"]')),()=>document.querySelector('[id*="'.concat(t.replace("#",""),'"]')),()=>document.querySelector('[class*="'.concat(t.replace(".",""),'"]')),()=>{if(i){return Array.from(document.querySelectorAll("h1, h2, h3, h4, h5, h6")).find((t=>t.textContent.trim().toLowerCase()===i.toLowerCase()))}return null},()=>{if(i){return Array.from(document.querySelectorAll("p, div, span, article, section, .product-card h3, .card-title")).find((t=>t.textContent.trim().toLowerCase()===i.toLowerCase()))}return null},()=>{const t=Array.from(document.querySelectorAll("h1, h2, h3, h4, h5, h6"));return this.findBestMatchingElement(t,e,i)},()=>{const t=Array.from(document.querySelectorAll("p, div, span, article, section, .product-card, .card"));return this.findBestMatchingElement(t,e,i)},()=>Array.from(document.querySelectorAll("[title], [alt], [aria-label]")).find((t=>(t.title||t.alt||t.getAttribute("aria-label")||"").toLowerCase().includes(e.toLowerCase())))];for(let h=0;h<n.length;h++)try{const t=n[h]();if(t)return t}catch(r){}return null}findBestMatchingElement(t,e,i){if(!t.length)return null;const n=t.filter((t=>t.textContent.toLowerCase().includes(e.toLowerCase())));if(!n.length)return null;if(i){const t=n.find((t=>t.textContent.trim().toLowerCase()===i.toLowerCase()));return t||n.reduce(((t,e)=>{const n=this.calculateTextSimilarity(t.textContent,i);return this.calculateTextSimilarity(e.textContent,i)>n?e:t}))}return n[0]}calculateTextSimilarity(t,e){const i=t.toLowerCase().trim(),n=e.toLowerCase().trim();if(i===n)return 1;const r=i.split(/\s+/),h=n.split(/\s+/),l=r.filter((t=>h.includes(t))),o=Math.max(r.length,h.length);return l.length/o}applyHighlighting(t,e,i){let n=!1;const r=this.determineContextType(i,e);this.highlightTermInElement(t,e,r)&&(n=!0);const h=t.querySelectorAll("h1, h2, h3, h4, h5, h6, p, span, div, a, li, td, th");return h.forEach((t=>{t.textContent.toLowerCase().includes(e.toLowerCase())&&this.highlightTermInElement(t,e,r)&&(n=!0)})),n}determineContextType(t,e){if("string"===typeof t)return t;if(t&&"object"===typeof t){if("phone"===t.field||"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"===t.fieldLabel)return"phone";if("address"===t.field||"\u0410\u0434\u0440\u0435\u0441\u0430"===t.fieldLabel)return"address";if("email"===t.field||"Email"===t.fieldLabel)return"email"}return/(\+?3?8?[\s-]?\(?0\d{2}\)?[\s-]?\d{3}[\s-]?\d{2}[\s-]?\d{2})|(\d{3}[\s-]?\d{2}[\s-]?\d{2})/.test(e)?"phone":/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/.test(e)?"email":e.toLowerCase().includes("\u043a\u0438\u0457\u0432")||e.toLowerCase().includes("\u0443\u043a\u0440\u0430\u0457\u043d")||e.toLowerCase().includes("\u043e\u0431\u043b\u0430\u0441\u0442\u044c")||e.toLowerCase().includes("\u0432\u0443\u043b.")?"address":null}scrollToElement(t){t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),t.classList.add("comspec-search-focus"),setTimeout((()=>{t.classList.remove("comspec-search-focus")}),3e3)}clearHighlights(){const t=document.querySelectorAll(".".concat(this.highlightClass));return t.forEach((t=>{const e=t.parentNode;if(e){const i=t.textContent,n=document.createTextNode(i);e.replaceChild(n,t),e.normalize()}})),this.currentHighlights=[],this.hideHighlightCounter(),t.length}showHighlightCounter(t,e){}hideHighlightCounter(){const t=document.getElementById("comspec-highlight-counter");t&&t.remove()}navigateHighlights(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next";if(0===this.currentHighlights.length)return console.warn("\u26a0\ufe0f \u041d\u0435\u043c\u0430\u0454 \u043f\u0456\u0434\u0441\u0432\u0456\u0447\u0435\u043d\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0456\u0432 \u0434\u043b\u044f \u043d\u0430\u0432\u0456\u0433\u0430\u0446\u0456\u0457"),!1;let e,i=this.currentHighlights.findIndex((t=>t.classList.contains("comspec-search-focus")));-1===i&&(i="next"===t?-1:this.currentHighlights.length),e="next"===t?(i+1)%this.currentHighlights.length:0===i?this.currentHighlights.length-1:i-1,i>=0&&this.currentHighlights[i]&&this.currentHighlights[i].classList.remove("comspec-search-focus");const n=this.currentHighlights[e];return!!n&&(this.scrollToElement(n),!0)}setupKeyboardShortcuts(){document.addEventListener("keydown",(t=>{("F3"===t.key||t.ctrlKey&&"g"===t.key)&&(t.preventDefault(),this.navigateHighlights("next")),(t.shiftKey&&"F3"===t.key||t.ctrlKey&&t.shiftKey&&"G"===t.key)&&(t.preventDefault(),this.navigateHighlights("prev")),"Escape"===t.key&&this.clearHighlights()}))}setupGlobalFunctions(){window.highlightSearchResults=(t,e,i)=>this.highlight(t,i),window.clearSearchHighlights=t=>this.clearHighlights(t),window.navigateToResult=(t,e)=>this.scrollToElementWithHighlight(t.selector||"body",e||t.text||"",t.context,t.element),window.navigateNextHighlight=()=>this.navigateHighlights("next"),window.navigatePrevHighlight=()=>this.navigateHighlights("prev"),window.SearchHighlighting=this,window.searchHighlighting=this}highlight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{container:i=document.body}=e;return this.highlightTermInElement(i,t)}test(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["\u043f\u0456\u0441\u043e\u043a","044","\u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430","COMSPEC"];console.log("\ud83e\uddea \u0422\u0435\u0441\u0442 \u043f\u0456\u0434\u0441\u0432\u0456\u0447\u0443\u0432\u0430\u043d\u043d\u044f..."),t.forEach(((e,i)=>{setTimeout((()=>{this.scrollToElementWithHighlight("body",e),i===t.length-1&&setTimeout((()=>this.clearHighlights()),3e3)}),2e3*i)}))}diagnose(){return{isInitialized:this.isInitialized,stylesInjected:!!document.getElementById("comspec-search-highlighting-styles"),currentHighlights:this.currentHighlights.length,globalFunctionsAvailable:{highlightSearchResults:!!window.highlightSearchResults,clearSearchHighlights:!!window.clearSearchHighlights,navigateToResult:!!window.navigateToResult}}}}let r=null;function h(){return r||(r=new n,window.contextSearch&&Object.assign(window.contextSearch,{highlightTermInElement:r.highlightTermInElement.bind(r),scrollToElementWithHighlight:r.scrollToElementWithHighlight.bind(r),clearHighlights:r.clearHighlights.bind(r),testHighlighting:r.test.bind(r),highlight:r.highlightTermInElement.bind(r),navigate:r.scrollToElementWithHighlight.bind(r),clear:r.clearHighlights.bind(r)})),r}"undefined"!==typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h()),t.exports&&(t.exports=n);const l=n}}]);
//# sourceMappingURL=540.36a5a3c8.chunk.js.map