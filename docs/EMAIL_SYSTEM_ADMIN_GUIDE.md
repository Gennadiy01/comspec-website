# üìß COMSPEC Email System - –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

> **–í–µ—Ä—Å—ñ—è:** 2.0  
> **–î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 31.07.2025  
> **–ê–≤—Ç–æ—Ä:** Claude AI Assistant  

## üìã –ó–º—ñ—Å—Ç

1. [–û–≥–ª—è–¥ —Å–∏—Å—Ç–µ–º–∏](#–æ–≥–ª—è–¥-—Å–∏—Å—Ç–µ–º–∏)
2. [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞)
3. [–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è](#–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è-—Ç–∞-—Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è)
4. [–ö–µ—Ä—É–≤–∞–Ω–Ω—è email –∞–¥—Ä–µ—Å–∞–º–∏](#–∫–µ—Ä—É–≤–∞–Ω–Ω—è-email-–∞–¥—Ä–µ—Å–∞–º–∏)
5. [–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏](#—Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è-—Å–∏—Å—Ç–µ–º–∏)
6. [–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞](#–º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥-—Ç–∞-–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
7. [–£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π](#—É—Å—É–Ω–µ–Ω–Ω—è-–Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π)
8. [–ë–µ–∑–ø–µ–∫–∞](#–±–µ–∑–ø–µ–∫–∞)
9. [–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è](#—Ä–µ–∑–µ—Ä–≤–Ω–µ-–∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è)
10. [FAQ](#faq)

---

## üîç –û–≥–ª—è–¥ —Å–∏—Å—Ç–µ–º–∏

### –û—Å–Ω–æ–≤–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª
COMSPEC Email System –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞–º –ø—Ä–æ –Ω–æ–≤—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó –∑ –≤–µ–±-—Å–∞–π—Ç—É.

### –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ
- ‚úÖ **–î–∏–Ω–∞–º—ñ—á–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è** email –∞–¥—Ä–µ—Å–∞–º–∏ —á–µ—Ä–µ–∑ Google Sheets
- ‚úÖ **Fallback –º–µ—Ö–∞–Ω—ñ–∑–º** –¥–ª—è –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ **–ê–∫—Ç–∏–≤–∞—Ü—ñ—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è** –∞–¥—Ä–µ—Å –±–µ–∑ –∑–º—ñ–Ω–∏ –∫–æ–¥—É
- ‚úÖ **–û–ø–∏—Å–∏ —Ä–æ–ª–µ–π** –¥–ª—è –∫–æ–∂–Ω–æ—ó –∞–¥—Ä–µ—Å–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** —Å–∏—Å—Ç–µ–º–∏

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Web Form      ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Google Apps     ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Gmail/Email    ‚îÇ
‚îÇ   (OrderModal)  ‚îÇ    ‚îÇ  Script          ‚îÇ    ‚îÇ  Recipients     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ  Google Sheets   ‚îÇ
                       ‚îÇ  Email_Settings  ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∏

1. **Web Form** - —Ñ–æ—Ä–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å–∞–π—Ç—ñ
2. **Google Apps Script** - –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ email
3. **Google Sheets** - –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è email –∞–¥—Ä–µ—Å
4. **Gmail API** - –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ MailApp

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Google Sheets

1. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ –æ—Å–Ω–æ–≤–Ω—É —Ç–∞–±–ª–∏—Ü—é:**
   ```
   https://docs.google.com/spreadsheets/d/1xJzmIKJ8vv7IY8Or5eiRmXbsfVbQL8ejZNqXP9OnTDY
   ```

2. **–°—Ç–≤–æ—Ä—ñ—Ç—å –∞—Ä–∫—É—à `Email_Settings`:**
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `+` –≤–Ω–∏–∑—É –µ–∫—Ä–∞–Ω—É
   - –ù–∞–∑–≤—ñ—Ç—å –∞—Ä–∫—É—à: `Email_Settings`

3. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   
   | A   | B                         | C      | D                    |
   |-----|---------------------------|--------|----------------------|
   | ID  | Email                     | Active | Description          |
   | 1   | sale3.maxigran@gmail.com  | TRUE   | –ü—Ä–æ–¥–∞–∂—ñ - –æ—Å–Ω–æ–≤–Ω–∏–π   |
   | 2   | gennadiy.d@ukr.net        | TRUE   | –î–∏—Ä–µ–∫—Ç–æ—Ä             |
   | 3   | maxigran.td@gmail.com     | TRUE   | –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä   |

### –ö—Ä–æ–∫ 2: –û–Ω–æ–≤–ª–µ–Ω–Ω—è Google Apps Script

1. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ Apps Script:**
   ```
   https://script.google.com
   ```

2. **–ó–Ω–∞–π–¥—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç COMSPEC**

3. **–°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–¥** –∑ —Ñ–∞–π–ª—É:
   ```
   D:\–ù–æ–≤–µ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–æ\MG\–°–∞–π—Ç\–ù–æ–≤–∏–π —Å–∞–π—Ç 2025\security-backup\google-apps-script.js
   ```

4. **–ó–±–µ—Ä–µ–∂—ñ—Ç—å –∫–æ–¥** (Ctrl+S)

### –ö—Ä–æ–∫ 3: –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

1. **–†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è ‚Üí –ö–µ—Ä—É–≤–∞—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º–∏**
2. **–†–µ–¥–∞–≥—É–≤–∞—Ç–∏** –æ—Å—Ç–∞–Ω–Ω—î —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
3. **–í–µ—Ä—Å—ñ—è:** "–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è"
4. **–†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏**

---

## üì¨ –ö–µ—Ä—É–≤–∞–Ω–Ω—è email –∞–¥—Ä–µ—Å–∞–º–∏

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –∞–¥—Ä–µ—Å–∏

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∞—Ä–∫—É—à `Email_Settings`
2. –î–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫:
   ```
   4 | new.manager@company.com | TRUE | –ù–æ–≤–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä
   ```
3. **üÜï –í–ê–ñ–õ–ò–í–û:** –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω:
   ```javascript
   clearEmailCache()
   ```

### –î–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è –∞–¥—Ä–µ—Å–∏

1. –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –∫–æ–ª–æ–Ω—Ü—ñ `Active`:
   ```
   TRUE ‚Üí FALSE
   ```
2. **üÜï –í–ê–ñ–õ–ò–í–û:** –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à:
   ```javascript
   clearEmailCache()
   ```

### –ó–º—ñ–Ω–∞ –∞–¥—Ä–µ—Å–∏

1. –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ email –≤ –∫–æ–ª–æ–Ω—Ü—ñ `Email`:
   ```
   old.email@domain.com ‚Üí new.email@domain.com
   ```
2. **üÜï –í–ê–ñ–õ–ò–í–û:** –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à:
   ```javascript
   clearEmailCache()
   ```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–ø–∏—Å—É

–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –∫–æ–ª–æ–Ω–∫—É `Description`:
```
–ö–µ—Ä—ñ–≤–Ω–∏–∫ –≤—ñ–¥–¥—ñ–ª—É –ø—Ä–æ–¥–∞–∂—ñ–≤
–ì–æ–ª–æ–≤–Ω–∏–π –±—É—Ö–≥–∞–ª—Ç–µ—Ä
–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏

### –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

**Google Apps Script Console:**
```javascript
testEmailSettings()
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î! –ó–Ω–∞–π–¥–µ–Ω–æ 3 –∞–∫—Ç–∏–≤–Ω–∏—Ö email –∞–¥—Ä–µ—Å.
```

### –¢–µ—Å—Ç 2: –û—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É (üÜï –í–ê–ñ–õ–ò–í–û)

**–ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –∑–º—ñ–Ω–∏ –≤ Google Sheets:**
```javascript
clearEmailCache()
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Google Sheets –∫–µ—à –æ—á–∏—â–µ–Ω–æ
üîÑ –ü–µ—Ä–µ—á–∏—Ç—É—î–º–æ email –∞–¥—Ä–µ—Å–∏...
üìß –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ X –∞–∫—Ç–∏–≤–Ω–∏—Ö email –∞–¥—Ä–µ—Å –∑ Google Sheets
```

### –¢–µ—Å—Ç 3: –î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

**–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –¥–∞–Ω–∏—Ö:**
```javascript
getCurrentEmails()
```

**–ü–æ–∫–∞–∂–µ:**
- –í—Å—ñ —Ä—è–¥–∫–∏ –∑ —Ç–∞–±–ª–∏—Ü—ñ
- –Ø–∫—ñ email –∞–∫—Ç–∏–≤–Ω—ñ/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ñ
- –¢–æ—á–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö

### –¢–µ—Å—Ç 4: Fallback –º–µ—Ö–∞–Ω—ñ–∑–º

1. –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ –∞—Ä–∫—É—à `Email_Settings` ‚Üí `Email_Settings_OFF`
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `testEmailSettings()`
3. **–û—á—ñ–∫—É—î—Ç—å—Å—è:** –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è fallback –∞–¥—Ä–µ—Å
4. –ü–æ–≤–µ—Ä–Ω—ñ—Ç—å –Ω–∞–∑–≤—É –∞—Ä–∫—É—à–∞

### –¢–µ—Å—Ç 5: –ñ–∏–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. –ó—Ä–æ–±—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ —Å–∞–π—Ç
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∂—É—Ä–Ω–∞–ª –≤–∏–∫–æ–Ω–∞–Ω–Ω—è Apps Script
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è email

### –§—É–Ω–∫—Ü—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

| –§—É–Ω–∫—Ü—ñ—è               | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                           |
|-----------------------|---------------------------------------|
| `testEmailSettings()` | –ü–æ–≤–Ω–∏–π —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º–∏ email             |
| `testEmailFunction()` | –¢–µ—Å—Ç –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏     |
| `getManagerEmails()`  | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–¥—Ä–µ—Å          |
| `getFallbackEmails()` | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∞–¥—Ä–µ—Å             |
| `clearEmailCache()`   | **üÜï** –û—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É —Ç–∞ –ø—Ä–∏–º—É—Å–æ–≤–µ –ø–µ—Ä–µ—á–∏—Ç—É–≤–∞–Ω–Ω—è |
| `getCurrentEmails()`  | **üÜï** –î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∞–Ω–∏—Ö –∑ —Ç–∞–±–ª–∏—Ü—ñ |

---

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ñ—É—Ä–Ω–∞–ª –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

**–î–æ—Å—Ç—É–ø:** Google Apps Script ‚Üí –í–∏–∫–æ–Ω–∞–Ω–Ω—è ‚Üí –ñ—É—Ä–Ω–∞–ª –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

**–ö–ª—é—á–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:**
```
üìß –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è email –∞–¥—Ä–µ—Å –∑ Google Sheets...
‚úÖ –î–æ–¥–∞–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏–π email: example@domain.com (–û–ø–∏—Å)
‚è∏Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–π email: disabled@domain.com
üìß –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ X –∞–∫—Ç–∏–≤–Ω–∏—Ö email –∞–¥—Ä–µ—Å –∑ Google Sheets
üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ email: X —É—Å–ø—ñ—à–Ω–æ, Y –ø–æ–º–∏–ª–æ–∫
```

### –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –ø—Ä–æ–±–ª–µ–º

**üö® –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏:**
```
‚ùå –ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è Email_Settings: [–¥–µ—Ç–∞–ª—ñ]
‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ email: [–¥–µ—Ç–∞–ª—ñ]
```

**‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:**
```
‚ö†Ô∏è –ê—Ä–∫—É—à Email_Settings –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ fallback
‚ö†Ô∏è –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏—Ö email –∞–¥—Ä–µ—Å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ fallback
```

### –ú–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º–∏

**–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —â–æ–¥–µ–Ω–Ω–æ:**
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏—Ö email
- –í—ñ–¥—Å–æ—Ç–æ–∫ —É—Å–ø—ñ—à–Ω–∏—Ö –≤—ñ–¥–ø—Ä–∞–≤–æ–∫
- –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–∏—Å—Ç–µ–º–∏
- –ü–æ–º–∏–ª–∫–∏ –≤ –∂—É—Ä–Ω–∞–ª—ñ

---

## üîß –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞: Email –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∂—É—Ä–Ω–∞–ª Apps Script
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞—Ä–∫—É—à `Email_Settings`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–∞–ø–∫—É "–°–ø–∞–º"

**–†—ñ—à–µ–Ω–Ω—è:**
```javascript
// –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤ Apps Script Console
testEmailSettings()
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ó–º—ñ–Ω–∏ –≤ Google Sheets –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è (üÜï)

**–°–∏–º–ø—Ç–æ–º–∏:**
- –ó–º—ñ–Ω–∏–ª–∏ –¥–∞–Ω—ñ –≤ —Ç–∞–±–ª–∏—Ü—ñ, –∞–ª–µ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞—Ä—ñ –∞–¥—Ä–µ—Å–∏
- –¢–µ—Å—Ç –ø–æ–∫–∞–∑—É—î –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–∞–Ω—ñ, –∞ –∂–∏–≤–∏–π —Ç–µ—Å—Ç - —Å—Ç–∞—Ä—ñ

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–µ—à—É–≤–∞–Ω–Ω—è Google Sheets

**–†—ñ—à–µ–Ω–Ω—è:**
1. **–ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –∑–º—ñ–Ω–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ:**
   ```javascript
   clearEmailCache()
   ```
2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```javascript
   getCurrentEmails()
   ```
3. **–ó–∞—á–µ–∫–∞–π—Ç–µ 30-60 —Å–µ–∫—É–Ω–¥** –ø—ñ—Å–ª—è –∑–º—ñ–Ω –≤ —Ç–∞–±–ª–∏—Ü—ñ

### –ü—Ä–æ–±–ª–µ–º–∞: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è fallback –∞–¥—Ä–µ—Å–∏

**–ü—Ä–∏—á–∏–Ω–∏:**
- –ê—Ä–∫—É—à `Email_Settings` –Ω–µ —ñ—Å–Ω—É—î
- –ê—Ä–∫—É—à –ø–æ—Ä–æ–∂–Ω—ñ–π
- –ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –∞–¥—Ä–µ—Å (`Active = TRUE`)
- –ö–µ—à –Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–∏–π –ø—ñ—Å–ª—è –∑–º—ñ–Ω

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–∑–≤—É –∞—Ä–∫—É—à–∞ (—Ç–æ—á–Ω–æ `Email_Settings`)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ —î –∞–¥—Ä–µ—Å–∏ –∑ `Active = TRUE`
4. **üÜï –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à:** `clearEmailCache()`

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ Google Sheets

**–ü–æ–º–∏–ª–∫–∞:**
```
Exception: You do not have permission to access the requested document
```

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ SPREADSHEET_ID –≤ –∫–æ–¥—ñ
2. –ù–∞–¥–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Ç–∞–±–ª–∏—Ü—ñ Google Apps Script
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ–∑–≤–æ–ª–∏ –ø—Ä–æ–µ–∫—Ç—É

### –ü—Ä–æ–±–ª–µ–º–∞: Email –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –Ω–µ –Ω–∞ –≤—Å—ñ –∞–¥—Ä–µ—Å–∏

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```javascript
// –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —è–∫—ñ –∞–¥—Ä–µ—Å–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è
console.log(getManagerEmails())
```

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–ª–æ–Ω–∫—É `Active` (–º–∞—î –±—É—Ç–∏ `TRUE`)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å email –∞–¥—Ä–µ—Å
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ–±–º–µ–∂–µ–Ω–Ω—è Gmail (–ª—ñ–º—ñ—Ç –≤—ñ–¥–ø—Ä–∞–≤–∫–∏)

---

## üîí –ë–µ–∑–ø–µ–∫–∞

### –ó–∞—Ö–∏—Å—Ç –¥–∞–Ω–∏—Ö

- ‚úÖ Email –∞–¥—Ä–µ—Å–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ñ–π Google Sheets
- ‚úÖ –î–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ —É –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –Ω–µ –º—ñ—Å—Ç–∏—Ç—å —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ Fallback –∞–¥—Ä–µ—Å–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∂–µ–Ω—ñ –¥–ª—è –±–µ–∑–ø–µ–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

1. **–û–±–º–µ–∂—Ç–µ –¥–æ—Å—Ç—É–ø** –¥–æ Google Sheets —Ç–∞–±–ª–∏—Ü—ñ
2. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ** —Å–ø–∏—Å–æ–∫ email –∞–¥—Ä–µ—Å
3. **–í–∏–¥–∞–ª—è–π—Ç–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
4. **–ú–æ–Ω—ñ—Ç–æ—Ä—Ç—å–µ –ª–æ–≥–∏** –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

### –î–æ–∑–≤–æ–ª–∏ Google Apps Script

**–ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏:**
- `https://www.googleapis.com/auth/spreadsheets` - —á–∏—Ç–∞–Ω–Ω—è Google Sheets
- `https://www.googleapis.com/auth/gmail.send` - –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ Gmail

---

## üíæ –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó

**–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è:**
```
D:\–ù–æ–≤–µ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–æ\MG\–°–∞–π—Ç\–ù–æ–≤–∏–π —Å–∞–π—Ç 2025\security-backup\
‚îú‚îÄ‚îÄ google-apps-script.js                    (–ø–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è)
‚îî‚îÄ‚îÄ google-apps-script-backup-before-*.js   (—Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó)
```

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–æ—ó –∫–æ–ø—ñ—ó

**–ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–∞–º–∏ –∑–∞–≤–∂–¥–∏:**
1. –°–∫–æ–ø—ñ—é–π—Ç–µ –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–¥ –∑ Google Apps Script
2. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑ –¥–∞—Ç–æ—é: `google-apps-script-backup-YYYY-MM-DD.js`
3. –ó–∞—Ñ—ñ–∫—Å—É–π—Ç–µ –≤ git

### –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

**–£ —Ä–∞–∑—ñ –ø—Ä–æ–±–ª–µ–º:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–¥ –≤ Google Apps Script
3. –ó–±–µ—Ä–µ–∂—ñ—Ç—å —Ç–∞ —Ä–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å

---

## ‚ùì FAQ

### –Ø–∫ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞?

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∞—Ä–∫—É—à `Email_Settings`
2. –î–æ–¥–∞–π—Ç–µ —Ä—è–¥–æ–∫: `ID | email@domain.com | TRUE | –û–ø–∏—Å`
3. **üÜï –í–ê–ñ–õ–ò–í–û:** –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à: `clearEmailCache()`

### –Ø–∫ —Ç–∏–º—á–∞—Å–æ–≤–æ –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è?

1. –ó–º—ñ–Ω—ñ—Ç—å `TRUE` –Ω–∞ `FALSE` –≤ –∫–æ–ª–æ–Ω—Ü—ñ `Active`
2. **üÜï –í–ê–ñ–õ–ò–í–û:** –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à: `clearEmailCache()`

### –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞?

1. **–ü–æ–≤–Ω–∏–π —Ç–µ—Å—Ç:** `testEmailSettings()` –≤ Google Apps Script Console
2. **üÜï –î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** `getCurrentEmails()`
3. **üÜï –û—á–∏—â–µ–Ω–Ω—è –∫–µ—à—É:** `clearEmailCache()`

### –©–æ —Ä–æ–±–∏—Ç–∏ —è–∫—â–æ email –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å?

1. **üÜï –°–ø–æ—á–∞—Ç–∫—É:** –ó–∞–ø—É—Å—Ç—ñ—Ç—å `clearEmailCache()`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∂—É—Ä–Ω–∞–ª Apps Script  
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `getCurrentEmails()` –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `testEmailSettings()`
5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–∞–ø–∫—É "–°–ø–∞–º"
6. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞—Ä–∫—É—à `Email_Settings`

### –°–∫—ñ–ª—å–∫–∏ email –∞–¥—Ä–µ—Å –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏?

**–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–æ:** –ù–µ–æ–±–º–µ–∂–µ–Ω–æ  
**–ü—Ä–∞–∫—Ç–∏—á–Ω–æ:** –î–æ 100 (–æ–±–º–µ–∂–µ–Ω–Ω—è Gmail API)

### –Ø–∫ –∑–º—ñ–Ω–∏—Ç–∏ —Ç–µ–∫—Å—Ç email –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è?

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é `formatEmailMessage()` –≤ Google Apps Script

### –ß–∏ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —É–º–æ–≤–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è?

–¢–∞–∫, –º–æ–¥–∏—Ñ—ñ–∫—É–π—Ç–µ –ª–æ–≥—ñ–∫—É –≤ `getManagerEmails()` –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∑–∞ —É–º–æ–≤–∞–º–∏

### –Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∑–∞–º–æ–≤–ª–µ–Ω—å?

–°—Ç–≤–æ—Ä—ñ—Ç—å –æ–∫—Ä–µ–º—ñ –∞—Ä–∫—É—à—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤:
- `Email_Settings_Orders` - –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω—å
- `Email_Settings_Consultations` - –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π

---

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

**–£ —Ä–∞–∑—ñ –ø—Ä–æ–±–ª–µ–º:**

1. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∂—É—Ä–Ω–∞–ª–∏** Google Apps Script
2. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–∏** —Å–∏—Å—Ç–µ–º–∏
3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é** Google Sheets
4. **–°—Ç–≤–æ—Ä—ñ—Ç—å backup** –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–∞–º–∏

**–ö–æ–Ω—Ç–∞–∫—Ç–∏ –¥–ª—è —Ç–µ—Ö–Ω—ñ—á–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏:**
- Email: tech@comspec.ua
- Telegram: @d_gennadiy
- –¢–µ–ª–µ—Ñ–æ–Ω: +380733864041

---

## üìù –Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω

| –í–µ—Ä—Å—ñ—è | –î–∞—Ç–∞       | –ó–º—ñ–Ω–∏                                |
|--------|------------|--------------------------------------|
| 2.0    | 31.07.2025 | –î–æ–¥–∞–Ω–æ –∫–µ—Ä—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ Google Sheets |
| 1.0    | 30.07.2025 | –ü–æ—á–∞—Ç–∫–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –∑ hardcoded –∞–¥—Ä–µ—Å–∞–º–∏|

---

**¬© 2025 COMSPEC - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏**